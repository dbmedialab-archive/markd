/*! jquery-markd - v0.3.0 - 2013-09-25 */
!function($){var pub={init:function(options){return this.each(function(){var $this=$(this);if($this.addClass("markd mousetrap"),$this.data("markd")||$this.data("markd",$.extend({},$.fn.markd.defaults,options)),!$this.is("textarea")){var t=$this.html();pub.setContent.apply($this,[t.replace(/(\r\n|\n|\r)/gm,"")])}if($this.bind("focus",function(){priv.focus.apply($this)}),$this.bind("blur",function(){priv.blur.apply($this)}),0===$(".markd-toolbar").length&&void 0!==$this.attr("data-markd-toolbar")){var toolbarStructure=[];toolbarStructure=$this.attr("data-markd-toolbar").length?$this.attr("data-markd-toolbar").replace("[","").replace("]","").split(","):$this.data("markd").toolbar;var toolbarParts={b:'<li><a data-action="bold" class="action bold">B</a></li>',i:'<li><a data-action="italic" class="action italic">I</a></li>',q:'<li><a data-action="quote" class="action quote"><svg class="icon" viewBox="0 0 20 20"><path d="M4.773,1.076C3.779,1.621,2.921,2.308,2.207,3.138C1.489,3.967,0.936,4.928,0.541,6.016 C0.179,7.011,0,8.071,0,9.19c0,0.107,0.001,0.213,0.005,0.322v8.642h8.264V9.228H4.637c0.028-1.232,0.277-2.266,0.742-3.112 c0.48-0.874,1.376-1.549,2.74-2.017l0.15-0.051V0l-0.25,0.033C6.853,0.183,5.77,0.531,4.773,1.076z M19.851,4.099L20,4.047V0 l-0.252,0.033c-1.164,0.15-2.247,0.499-3.244,1.043c-0.995,0.545-1.853,1.232-2.567,2.062c-0.717,0.829-1.272,1.791-1.665,2.878 c-0.362,0.995-0.542,2.055-0.542,3.172c0,0.109,0.002,0.215,0.005,0.324v8.642H20V9.228h-3.633c0.026-1.232,0.277-2.266,0.742-3.112 C17.589,5.242,18.486,4.567,19.851,4.099z"/></svg></a></li>',l:'<li><a data-action="link" class="action link"><svg class="icon" viewBox="0 0 20 20"><path d="M10.204,13.854c-1.288,0.001-2.579-0.503-3.551-1.477l0,0l-0.154-0.154l2.206-2.206l0.154,0.154 c0.38,0.379,0.859,0.562,1.345,0.563l0,0c0.508-0.001,0.994-0.185,1.373-0.563l0,0l3.615-3.616 c0.379-0.379,0.562-0.863,0.563-1.362l0,0c-0.002-0.494-0.185-0.977-0.562-1.356l0,0L15.04,3.683 c-0.38-0.378-0.863-0.562-1.359-0.563l0,0c-0.498,0.002-0.98,0.185-1.36,0.563l0,0l-1.486,1.487c-0.608,0.609-1.596,0.609-2.206,0 l0,0c-0.609-0.609-0.609-1.597,0-2.206l0,0l1.487-1.486c0.98-0.981,2.28-1.479,3.565-1.477l0,0 c1.284-0.002,2.584,0.496,3.564,1.477l0,0l0.154,0.153c0.979,0.979,1.478,2.277,1.477,3.562l0,0 c0.001,1.285-0.494,2.586-1.477,3.568l0,0l-3.617,3.616c-0.986,0.988-2.29,1.478-3.57,1.478l0,0 C10.209,13.854,10.207,13.854,10.204,13.854L10.204,13.854z"/><path d="M5.182,20c-1.288,0.001-2.579-0.503-3.551-1.477l0,0l-0.154-0.154C0.493,17.386-0.002,16.084,0,14.8l0,0 c-0.002-1.285,0.498-2.582,1.477-3.561l0,0l3.616-3.616c0.98-0.981,2.28-1.479,3.565-1.477l0,0 c1.007-0.001,2.023,0.304,2.888,0.909l0,0c0.144,0.073,0.277,0.169,0.396,0.289l0,0l0.279,0.28l0.154,0.153l0,0v0l-2.205,2.206l0,0 l-0.154-0.154c-0.38-0.378-0.862-0.561-1.359-0.563l0,0C8.16,9.268,7.678,9.451,7.299,9.829l0,0l-3.617,3.616 c-0.378,0.38-0.561,0.86-0.563,1.354l0,0c0.002,0.501,0.186,0.984,0.563,1.364l0,0l0.154,0.153c0.38,0.379,0.859,0.562,1.345,0.562 l0,0c0.509-0.002,0.994-0.185,1.373-0.562l0,0l1.558-1.558c0.609-0.609,1.597-0.609,2.206,0l0,0c0.609,0.609,0.609,1.596,0,2.205 l0,0L8.76,18.523C7.774,19.511,6.47,20,5.189,20l0,0C5.187,20,5.185,20,5.182,20L5.182,20z"/></svg></a></li>'},toolbar=[];toolbar.push('<ul class="markd-toolbar">'),$.each(toolbarStructure,function(index,value){toolbar.push(toolbarParts[value])}),toolbar.push("</ul>"),toolbar=toolbar.join(""),$("body").prepend(toolbar)}})},getContent:function(){var content=[];return this.each(function(){var $this=$(this);content.push(priv.getContent.apply($this))}),content},setContent:function(content){return this.each(function(){var $this=$(this);$this.data("markd"),$this.is("textarea")?$this.val(content):(content=content.replace(/(\r\n|\n|\r)/gm,"<br>"),$this.html(content))})},setCursor:function(position){return this.each(function(){var $this=$(this),t=priv.getContent.apply($this);if(!$this.is("textarea")){var newlines=t.substr(0,position).match(/(\r\n|\n|\r)/gm);null!==newlines&&(position-=newlines.length)}$this.selection(position,position)})},stats:function(){return this.each(function(){priv.stats.apply($this)})}},priv={tab:function(){var $this=$(this),s=priv.getSelection.apply($this),t=priv.getContent.apply($this);t=priv.insert(t,s.end,"	"),pub.setContent.apply($this,[t]),pub.setCursor.apply($this,[s.end+1])},link:function(){var $this=$(this),s=priv.getSelection.apply($this),t=priv.getContent.apply($this),l=t.substring(s.start,s.end).match(/(http|https|ftp):\/\//);null!==l?(t=priv.insert(t,s.end,")"),t=priv.insert(t,s.start,"[]("),pub.setContent.apply($this,[t]),pub.setCursor.apply($this,[s.start+1])):(t=priv.insert(t,s.end,"]()"),t=priv.insert(t,s.start,"["),pub.setContent.apply($this,[t]),pub.setCursor.apply($this,[s.end+3]))},code:function(){var $this=$(this),s=priv.getSelection.apply($this),t=priv.getContent.apply($this);t=priv.insert(t,s.end,"`"),t=priv.insert(t,s.start,"`"),pub.setContent.apply($this,[t]),pub.setCursor.apply($this,[s.end+2])},bold:function(){var $this=$(this),s=priv.getSelection.apply($this),t=priv.getContent.apply($this);t=priv.insert(t,s.end,"__"),t=priv.insert(t,s.start,"__"),pub.setContent.apply($this,[t]),pub.setCursor.apply($this,[s.end+4])},italic:function(){var $this=$(this),s=priv.getSelection.apply($this),t=priv.getContent.apply($this);t=priv.insert(t,s.end,"_"),t=priv.insert(t,s.start,"_"),pub.setContent.apply($this,[t]),pub.setCursor.apply($this,[s.end+2])},quote:function(){var $this=$(this),s=priv.getSelection.apply($this),t=priv.getContent.apply($this);t=0===t.substr(s.start-1,1).search(/\n/g)?priv.insert(t,s.start,"> "):priv.insert(t,s.start,"\n> "),pub.setContent.apply($this,[t]),pub.setCursor.apply($this,[s.end+3])},stats:function(){var $this=$(this),text=priv.getContent.apply($this);alert("Antall tegn: "+text.length+"\nAntall ord: "+text.split(" ").length+"\nAntall avsnitt: "+text.split("\n").length)},focus:function(){var $this=$(this),data=$this.data("markd");if(0!==$(".markd-toolbar").length&&void 0!==$this.attr("data-markd-toolbar")){var $toolbar=$(".markd-toolbar");$toolbar.find(".action").each(function(index,element){$(element).unbind("click").on("click",function(){priv[$(element).attr("data-action")].apply($this),$toolbar.hide()})}),$(document).unbind("mouseup").on("mouseup",function(event){var selection=priv.getSelection.apply($this);if(selection.width){var xy={top:event.pageY-60,left:event.pageX-$toolbar.width()/2};$toolbar.show().css(xy)}else $toolbar.hide()})}for(var key in data.kbd)data.kbd.hasOwnProperty(key)&&priv.bind.apply($this,[data.kbd[key],key])},bind:function(kbd,method){var $this=$(this);$this.data("markd"),Mousetrap.bind(kbd,function(){return priv[method].apply($this),!1})},blur:function(){var $this=$(this);$this.data("markd"),$(document).unbind("mouseup"),Mousetrap.reset(),setTimeout(function(){$(".markd-toolbar").hide()},500)},insert:function(string,index,insert){return index>0?string.substring(0,index)+insert+string.substring(index,string.length):insert+string},getContent:function(){var $this=$(this);if($this.is("textarea"))return $this.val();var content;return content=document.getElementById($this.attr("id")).innerText?document.getElementById($this.attr("id")).innerText:document.getElementById($this.attr("id")).textContent,content=content.replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getSelection:function(){var $this=$(this),selection=$this.selection();if(!$this.is("textarea")){var t=priv.getContent.apply($this).substr(0,selection.end),newlines=t.match(/(\r\n|\n|\r)/gm);if(null!==newlines){var n=priv.getContent.apply($this).substr(0,selection.end+newlines.length).match(/(\r\n|\n|\r)/gm);selection.start+=n.length,selection.end+=n.length,priv.getContent.apply($this).substring(selection.start,selection.end).match(/(\r\n|\n|\r)/gm)&&(selection.start++,selection.end++)}}return selection}};$.fn.markd=function(method){return pub[method]?pub[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?($.error("Method "+method+" does not exist on jQuery.markd"),void 0):pub.init.apply(this,arguments)},$.fn.markd.defaults={kbd:{tab:"tab",bold:"mod+b",italic:"mod+i",code:"mod+k",link:"mod+l",stats:"mod+alt+i"},toolbar:["b","i","q","l"]}}(jQuery);
/*
//@ sourceMappingURL=jquery-markd.sourcemap.js
*/